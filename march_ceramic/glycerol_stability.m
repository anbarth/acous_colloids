load('data/glycerol_stability_05_20.mat')
load('data/phi59_batch1_stability_05_23.mat')
load('data/glycerol_05_21.mat')
load('data/glycerol_variation_05_23.mat')
load('data/phi59_variation_05_27.mat')
load('data/phi59_variation_05_27_part2.mat')


% all of these are w non-segregated particles
% all of these mix some acoustic testing and some repeated stress sweeps
phi44_batch2_sample1 = {glycerol_phi44_sample1_05_20.sweep1,glycerol_phi44_sample1_05_20.sweep2,...
    glycerol_phi44_sample1_05_20.sweep3,glycerol_phi44_sample1_05_20.sweep4,...
    glycerol_phi44_sample1_05_20.sweep5,glycerol_phi44_sample1_05_20.sweep6,...
    glycerol_phi44_sample1_05_20.sweep7,glycerol_phi44_sample1_05_20.sweep8,...
    glycerol_phi44_sample1_05_20.sweep9,glycerol_phi44_sample1_05_20.sweep10,...
    glycerol_phi44_sample1_05_20.sweep11,glycerol_phi44_sample1_05_20.sweep12,...
    glycerol_phi44_sample1_05_20.sweep13,glycerol_phi44_sample1_05_20.sweep14,...
    glycerol_phi44_sample1_05_20.sweep15,glycerol_phi44_sample1_05_20.sweep16,...
    glycerol_phi44_sample1_05_20.sweep17};

phi44_batch2_sample2 = {glycerol_phi44_sample2_05_21.sweep1,glycerol_phi44_sample2_05_21.sweep2,...
    glycerol_phi44_sample2_05_21.sweep3,glycerol_phi44_sample2_05_21.sweep4,...
    glycerol_phi44_sample2_05_21.sweep5,glycerol_phi44_sample2_05_21.sweep6,...
    glycerol_phi44_sample2_05_21.sweep7};

phi44_batch3_sample1 = {glycerol_batch3_sample1_05_22.sweep1,glycerol_batch3_sample1_05_22.sweep2,...
    glycerol_batch3_sample1_05_22.sweep3,glycerol_batch3_sample1_05_22.sweep4,...
    glycerol_batch3_sample1_05_22.sweep5,glycerol_batch3_sample1_05_22.sweep6,...
    glycerol_batch3_sample1_05_22.sweep7};

% 59% batch 1 sample 1, non-segregated particles
phi59_batch1_sample1 = {phi59_batch1_stability_05_23.sample1_sweep1,...
    phi59_batch1_stability_05_23.sample1_sweep2,...
    phi59_batch1_stability_05_23.sample1_sweep3,...
    phi59_batch1_stability_05_23.sample1_sweep4,...
    phi59_batch1_stability_05_23.sample1_sweep5,...
    phi59_batch1_stability_05_23.sample1_sweep6,...
    phi59_batch1_stability_05_23.sample1_sweep7,...
    phi59_batch1_stability_05_23.sample1_sweep8,...
    phi59_batch1_stability_05_23.sample1_sweep9,...
    phi59_batch1_stability_05_23.sample1_sweep10,...
    phi59_batch1_stability_05_23.sample1_sweep11,...
    phi59_batch1_stability_05_23.sample1_sweep12,...
    phi59_batch1_stability_05_23.sample1_sweep13,...
    phi59_batch1_stability_05_23.sample1_sweep14,...
    phi59_batch1_stability_05_23.sample1_sweep15,...
    phi59_batch1_stability_05_23.sample1_sweep16};

% 59% batch 1 sample 2, non-segregated particles
phi59_batch1_sample2 = {phi59_batch1_stability_05_23.sample2_sweep1,...
    phi59_batch1_stability_05_23.sample2_sweep2,...
    phi59_batch1_stability_05_23.sample2_sweep3};

% 59% batch A sample 3, segregated particles
phi59_batchA_sample3 = {phi59_A_3_05_27.A_3_sweep1,...
    phi59_A_3_05_27.A_3_sweep2,...
    phi59_A_3_05_27.A_3_sweep3,...
    phi59_A_3_05_27.A_3_sweep4,...
    phi59_A_3_05_27.A_3_sweep5,...
    phi59_A_3_05_27.A_3_sweep6,...
    phi59_A_3_05_27.A_3_sweep7,...
    phi59_A_3_05_27.A_3_sweep8,...
    phi59_A_3_05_27.A_3_sweep9};

% NOTE i have removed the 7th stress sweep bc its a huge outlier
phi59_batchB_sample2 = {phi59_variation_05_27.B_2_sweep1,phi59_variation_05_27.B_2_sweep2,...
    phi59_variation_05_27.B_2_sweep3,phi59_variation_05_27.B_2_sweep4,...
    phi59_variation_05_27.B_2_sweep5,phi59_variation_05_27.B_2_sweep6,... 
    phi59_variation_05_27.B_2_sweep8,... %phi59_variation_05_27.B_2_sweep7,phi59_variation_05_27.B_2_sweep8,...
    phi59_variation_05_27.B_2_sweep9,phi59_variation_05_27.B_2_sweep10,...
    phi59_variation_05_27.B_2_sweep11,phi59_variation_05_27.B_2_sweep12,...
    phi59_variation_05_27.B_2_sweep13,phi59_variation_05_27.B_2_sweep14};




% phi59_batchA_sample3 = {phi59_A_3_05_27.A_3_low1,phi59_A_3_05_27.A_3_sweep1,...
%     phi59_A_3_05_27.A_3_low2,phi59_A_3_05_27.A_3_sweep2,...
%     phi59_A_3_05_27.A_3_low3,phi59_A_3_05_27.A_3_sweep3,...
%     phi59_A_3_05_27.A_3_low4,phi59_A_3_05_27.A_3_sweep4,...
%     phi59_A_3_05_27.A_3_low5,phi59_A_3_05_27.A_3_sweep5,...
%     phi59_A_3_05_27.A_3_low6,phi59_A_3_05_27.A_3_sweep6,...
%     phi59_A_3_05_27.A_3_low7,phi59_A_3_05_27.A_3_sweep7,...
%     phi59_A_3_05_27.A_3_low8,phi59_A_3_05_27.A_3_sweep8,...
%     phi59_A_3_05_27.A_3_low9,phi59_A_3_05_27.A_3_sweep9};




%all_loads = {phi44_batch2_sample1,phi44_batch2_sample2,phi44_batch3_sample1,phi59_batch1_sample1,phi59_batch1_sample2,phi59_batchA_sample3,phi59_batchB_sample2};
%colors = ["#0072BD","#0072BD","#0072BD","#77AC30","#77AC30","#77AC30","#77AC30"];
%blue, green

all_loads = {phi44_batch2_sample1,phi44_batch2_sample2,phi44_batch3_sample1};
%all_loads = {phi59_batch1_sample1,phi59_batch1_sample2,phi59_batchA_sample3,phi59_batchB_sample2};
colors = ["#0072BD","#77AC30","#a136ff","#ffb917"];
% blue green purple yellow
sigma=10;
figure; hold on;
ax1 = gca;
%ylim([-0.2 0.2])
%xlim([0 60*9])
CSS = (50/19)^3;
ylabel(strcat('\Delta\eta/\eta(t=0) at \sigma=',num2str(round(sigma*CSS*10)/10),' Pa'))
xlabel('t (min)')

%for ii=4
for ii=1:length(all_loads)
    mySweeps = all_loads{ii};
    eta_over_t = zeros(length(mySweeps),1);
    t = zeros(length(mySweeps),1);

    initSweep = mySweeps{1};
    t_init = initSweep.datetime(1);
    [sigma_init,eta_init_sweep] = getStressSweep(initSweep);
    eta_init = eta_init_sweep(sigma_init==sigma);
    eta_over_t(1) = eta_init;
    t(1) = 0;

    for jj=1:length(mySweeps)
        mySweep = mySweeps{jj};
        myT = mySweep.datetime(1);
        [sigma_sweep,eta] = getStressSweep(mySweep);

        t(jj) = minutes(myT-t_init);
        if t(jj) < 0
            t(jj) = t(jj)+24*60;
        end
        %eta_over_t(jj) = eta(sigma_sweep==sigma);
        eta_over_t(jj) = (eta(sigma_sweep==sigma)-eta_init)/eta_init;
    end

    plot(t,eta_over_t,'-o','LineWidth',1,'Color',colors(ii))
end
